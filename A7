--Andrew McQuillen		CIS 310-07		October 26, 2015		Assignment 7

--1
SELECT	DEPT_NAME 
FROM	LGDEPARTMENT

--2
SELECT	PROD_SKU, PROD_DESCRIPT, PROD_TYPE, PROD_CATEGORY, PROD_PRICE
FROM	LGPRODUCT
WHERE	PROD_BASE = 'WATER' AND 
		PROD_CATEGORY = 'SEALER'

--3
SELECT	EMP_FNAME, EMP_LNAME, EMP_EMAIL
FROM	LGEMPLOYEE
WHERE	EMP_HIREDATE BETWEEN 'JANUARY 1,2001' AND 
		'DECEMBER 31, 2010'
ORDER BY	EMP_LNAME ASC, EMP_FNAME ASC

--4
SELECT	EMP_FNAME, EMP_LNAME, EMP_PHONE, EMP_TITLE, DEPT_NUM
FROM	LGEMPLOYEE
WHERE	DEPT_NUM = '300' OR 
		EMP_TITLE = 'CLERK I'
ORDER BY	EMP_LNAME ASC, EMP_FNAME ASC

--5
SELECT	E.EMP_NUM, E.EMP_LNAME, E.EMP_FNAME, 
		S.SAL_FROM, S.SAL_END,S.SAL_AMOUNT
FROM	LGSALARY_HISTORY S INNER JOIN LGEMPLOYEE E
		ON E.EMP_NUM = S.EMP_NUM
WHERE	E.EMP_NUM IN ('83731', '83745', '84039')
ORDER BY	E.EMP_NUM ASC, S.SAL_FROM ASC

--6
SELECT	DISTINCT CUST_FNAME, CUST_LNAME, CUST_STREET
		CUST_CITY, CUST_STATE, CUST_ZIP
FROM	LGCUSTOMER C INNER JOIN LGINVOICE I
		ON C.CUST_CODE = I.CUST_CODE
		INNER JOIN LGLINE L
		ON I.INV_NUM = L.INV_NUM
		INNER JOIN LGPRODUCT P
		ON L.PROD_SKU = P.PROD_SKU
		INNER JOIN LGBRAND B
		ON P.BRAND_ID = B.BRAND_ID
WHERE	BRAND_NAME = 'FORESTERS BEST' AND
		PROD_CATEGORY = 'TOP COAT' AND
		INV_DATE BETWEEN '15-JUL-2013' AND '31-JUL-2013'
ORDER BY	CUST_STATE, CUST_LNAME, CUST_FNAME

--7
SELECT	E.EMP_NUM, E.EMP_LNAME, E.EMP_EMAIL, E.EMP_TITLE, D.DEPT_NUM, D.DEPT_NAME
FROM	LGEMPLOYEE E INNER JOIN LGDEPARTMENT D
		ON E.DEPT_NUM = D.DEPT_NUM
WHERE	E.EMP_TITLE LIKE '%ASSOCIATE'
ORDER BY	D.DEPT_NAME ASC, E.EMP_TITLE ASC

--8
SELECT	B.BRAND_NAME, SUM(P.PROD_QOH) AS [TOTAL QOH]
FROM	LGBRAND B INNER JOIN LGPRODUCT P
		ON B.BRAND_ID = P.BRAND_ID
GROUP BY	B.BRAND_NAME

--9
SELECT	PROD_CATEGORY, COUNT(PROD_BASE) AS [COUNT OF WATER BASE] 
FROM	LGPRODUCT
WHERE	PROD_BASE = 'WATER'
GROUP BY	PROD_CATEGORY

--10
SELECT	PROD_BASE, PROD_TYPE, COUNT(PROD_SKU) AS [COUNT]
FROM	LGPRODUCT
GROUP BY	PROD_BASE, PROD_TYPE

--11
SELECT	BRAND_ID, SUM(PROD_QOH) AS [TOTAL QOH]
FROM	LGPRODUCT
GROUP BY	BRAND_ID
ORDER BY	BRAND_ID DESC

--12
SELECT	B.BRAND_ID, B.BRAND_NAME, CAST(AVG(P.PROD_PRICE) AS DECIMAL (10,2)) AS [AVG PRICE]
FROM	LGBRAND B INNER JOIN LGPRODUCT P
		ON B.BRAND_ID = P.BRAND_ID
GROUP BY	B.BRAND_ID, B.BRAND_NAME
ORDER BY	B.BRAND_NAME

--13
SELECT	DEPT_NUM, MAX(EMP_HIREDATE) AS [MOST RECENT HIRE]
FROM	LGEMPLOYEE
GROUP BY	DEPT_NUM
ORDER BY	[MOST RECENT HIRE]

--14
SELECT	E.EMP_NUM, E.EMP_FNAME, E.EMP_LNAME, MAX(S.SAL_AMOUNT) AS [HIGHEST SALARY]
FROM	LGEMPLOYEE E INNER JOIN LGSALARY_HISTORY S
		ON E.EMP_NUM = S.EMP_NUM
WHERE	DEPT_NUM = '200'
Group By	e.emp_num, e.emp_fname, e.emp_lname
ORDER BY	[HIGHEST SALARY] DESC

--15
SELECT	C.CUST_CODE, C.CUST_FNAME, C.CUST_LNAME, SUM(I.INV_TOTAL) AS [SUM OF TOTAL]
FROM	LGCUSTOMER C INNER JOIN LGINVOICE I
		ON C.CUST_CODE = I.CUST_CODE
GROUP BY	C.CUST_CODE, c.cust_fname, c.cust_lname
HAVING		SUM(I.INV_TOTAL) > '1500'
ORDER BY	[SUM OF TOTAL] DESC

--16
SELECT	 E.EMP_LNAME, D.DEPT_NUM, D.DEPT_NAME, D.DEPT_PHONE, D.EMP_NUM
FROM	LGDEPARTMENT D INNER JOIN LGEMPLOYEE E
		ON D.EMP_NUM = E.EMP_NUM
ORDER BY	E.EMP_LNAME

--17
SELECT	V.VEND_ID, V.VEND_NAME, B.BRAND_NAME, COUNT(P.PROD_QOH) AS [TOTAL QOH]
FROM	LGBRAND B INNER JOIN LGPRODUCT P 
		ON B.BRAND_ID = P.BRAND_ID
		INNER JOIN LGSUPPLIES S
		ON P.PROD_SKU = S.PROD_SKU
		INNER JOIN LGVENDOR V
		ON S.VEND_ID = V.VEND_ID 
GROUP BY	V.VEND_NAME, B.BRAND_NAME, V.VEND_ID
ORDER BY	V.VEND_NAME, B.BRAND_NAME

--18
SELECT	E.EMP_NUM, E.EMP_FNAME, E.EMP_LNAME, SUM(I.INV_TOTAL) AS [TOTAL INVOICES]
FROM	LGINVOICE AS I INNER JOIN LGEMPLOYEE AS E
		ON E.EMP_NUM = I.EMPLOYEE_ID
GROUP BY	EMP_NUM, EMP_LNAME, EMP_FNAME
ORDER BY	EMP_LNAME, EMP_FNAME

--19
SELECT MAX(A.AVGPRICE) AS [LARGEST AVERAGE]
FROM	(
		 SELECT	BRAND_ID, AVG(PROD_PRICE) AS AVGPRICE
		 FROM	LGPRODUCT
		 GROUP BY	BRAND_ID
		) AS A
					
--20
SELECT	A.BRAND_ID, A.BRAND_NAME, A.BRAND_TYPE, A.AVGPRICE
FROM	(
		 SELECT P.BRAND_ID, AVG(P.PROD_PRICE) AS AVGPRICE, B.BRAND_NAME, B.BRAND_TYPE
		 FROM	LGPRODUCT P INNER JOIN LGBRAND B ON P.BRAND_ID = B.BRAND_ID
		 GROUP BY	P.BRAND_ID, B.BRAND_NAME, B.BRAND_TYPE
		) AS A
WHERE	AVGPRICE = (
					SELECT MAX(B.AVGPRICE) AS 'LARGEST AVERAGE'
					FROM	(
							 SELECT	BRAND_ID, AVG(PROD_PRICE) AS AVGPRICE
							 FROM	LGPRODUCT
							 GROUP BY	BRAND_ID
							) AS B
					)
--21
SELECT	E.EMP_LNAME + ', ' + E.EMP_FNAME AS EMPLOYEE, C.CUST_LNAME + ', ' + C.CUST_FNAME AS CUSTOMER, I.INV_DATE, I.INV_TOTAL
FROM	LGEMPLOYEE E INNER JOIN LGINVOICE I
		ON E.EMP_NUM = I.EMPLOYEE_ID
		INNER JOIN LGCUSTOMER C
		ON I.CUST_CODE = C.CUST_CODE
WHERE	C.CUST_LNAME = 'HAGAN' AND
		I.INV_DATE = '2013-05-18'
		

		
